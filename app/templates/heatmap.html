{% extends "bootstrap/base.html" %}

{% block title %}
Heatmap
{% endblock %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
{% endblock %}
<style>
#mapid {
height: 180px;
}
</style>

{% block content %}
<div id="test">test</div>
<div id="mapid" style="width: 1600px; height: 1400px; position: relative; outline: none;"></div>


<script>
var markList = [];
var mymap = L.map('mapid').setView([51.505, -0.09], 13);
//var marker = L.marker([51.5, -0.09]).addTo(mymap);
send();
function send() {
	var person = {
		name: $("#test").val(),
	}
	$.ajax({
		url: '/getLocations',
		type: 'post',
		dataType: 'json',
		success: function (data) {
			for(var i =0;i<data.marks.length;i++){
				console.log(i);
				console.log("x: ",data.marks[i][0],"y: ",data.marks[i][1]);
				markList[i] = L.marker([data.marks[i][1],data.marks[i][0]]).addTo(mymap);
				markList[i].bindPopup("<form class='form-inline'><input class='form-control form-control-sm' type='text' placeholder='Where is here?'><button type='submit' class='btn btn-primary'>Confirm</button></form>").openPopup();
			}
		},
	});
}
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
maxZoom: 18,
attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
id: 'mapbox.streets'
}).addTo(mymap);
//marker.bindPopup("<form class='form-inline'><input class='form-control form-control-sm' type='text' placeholder='Where is here?'><button type='submit' class='btn btn-primary'>Confirm</button></form>").openPopup();
</script>

{% endblock %}